"use strict";(self.webpackChunkmainapp=self.webpackChunkmainapp||[]).push([[671],{671:(e,t,n)=>{n.r(t),n.d(t,{onStart:()=>h});var o=n(593),a=n(779),i=n(565);class s extends a.Z{connectedApps=[];static getConfig(){return{className:"MainApp.view.MainContainerController"}}changeItemAmount(e){let t=e.component.value;MainApp.canvas.Helper.changeItemsAmount(t),this.component.items[1].items.forEach((e=>{"itemAmount"===e.toggleGroup&&(e.pressed=e.value===t)}))}createPopupWindow(e,t,n){let o=this;Neo.Main.getWindowData().then((a=>{o.component.getDomRect(o.getReference(e).id).then((e=>{let{height:o,left:i,top:s,width:p}=e;o-=50,i+=a.screenLeft,s+=a.outerHeight-a.innerHeight+a.screenTop,Neo.Main.windowOpen({url:`../${t}/index.html`,windowFeatures:`height=${o},left=${i},top=${s},width=${p}`,windowName:n})}))}))}getMainView(e){return e&&"MainApp"!==e?Neo.apps[e].mainView:this.component}moveCanvas(e){this.createPopupWindow("webgl-component","childapp","ChildApp")}onAppConnect(e){let t=this,n=e.appName,o=t.getReference("webgl-component");console.log("onAppConnect",n),"ChildApp"===n&&(t.getReference("webgl-container").remove(o,!1),i.Z.add(t.connectedApps,n),Neo.apps[n].on("render",(()=>{setTimeout((()=>{t.getMainView(n).add(o)}),100)})))}onAppDisconnect(e){let t=this,n=e.appName,o=t.getReference("webgl-component");switch(console.log("onAppDisconnect",n),n){case"ChildApp":i.Z.remove(t.connectedApps,n),t.getMainView(n).remove(o,!1),t.getReference("webgl-container").add(o);break;case"MainApp":Neo.Main.windowClose({appName:n,names:t.connectedApps})}Neo.apps[n].destroy()}onConstructed(){super.onConstructed();let e=this;Neo.currentWorker.on({connect:e.onAppConnect,disconnect:e.onAppDisconnect,scope:e})}onStopAnimationButtonClick(e){let t,n=!0;"Stop Animation"===e.component.text?(t="Start Animation",n=!1):t="Stop Animation",e.component.text=t,MainApp.canvas.Helper.enableAnimation(n)}onStopMainButtonClick(e){Neo.Main.alert({appName:this.getReference("webgl-component").appName,message:["This alert pauses the JS main thread.\n\n","Notice that the time inside the bottom toolbar has stopped updating.\n\n","Closing this alert will resume the main thread."].join("")})}}Neo.applyClassConfig(s);const p=s;var r=n(901),c=n(668),m=n(683);class l extends m.Z{static getConfig(){return{className:"Neo.component.Canvas",ntype:"canvas",offscreen:!0,offscreenRegistered_:!1,_vdom:{tag:"canvas"}}}afterSetMounted(e,t){super.afterSetMounted(e,t);let n=this,o=n.getCanvasId(),a=n.offscreen,i=Neo.currentWorker;e&&a?i.promiseMessage("main",{action:"getOffscreenCanvas",appName:n.appName,nodeId:o}).then((e=>{i.promiseMessage("canvas",{action:"registerCanvas",node:e.offscreen,nodeId:o},[e.offscreen]).then((()=>{n.offscreenRegistered=!0}))})):a&&(n.offscreenRegistered=!1)}getCanvasId(){return this.id}}Neo.applyClassConfig(l);const d=l;class g extends d{static getConfig(){return{className:"MainApp.view.WebGlComponent",_vdom:{tag:"d3fc-canvas",cn:[{tag:"canvas"}]}}}afterSetId(e,t){this.vdom.cn[0].id=`${e}__canvas`,super.afterSetId(e,t)}afterSetOffscreenRegistered(e,t){if(e){let e=this,t=e.domListeners;t.push({measure:e.onMeasure,scope:e}),e.domListeners=t,setTimeout((()=>{MainApp.canvas.Helper.renderSeries(this.getCanvasId()),Neo.main.DomAccess.getBoundingClientRect({appName:e.appName,id:e.id}).then((t=>{e.updateSize(t.height,t.width)}))}),50)}}getCanvasId(){return this.vdom.cn[0].id}onMeasure(e){let t=e.path[0];this.updateSize(t.clientHeight,t.clientWidth)}updateSize(e,t){MainApp.canvas.Helper.updateSize({height:e,width:t})}}Neo.applyClassConfig(g);class u extends c.Z{static getConfig(){return{className:"MainApp.view.MainContainer",autoMount:!0,controller:p,items:[{ntype:"container",flex:1,items:[{module:g,reference:"webgl-component"}],layout:{ntype:"fit"},reference:"webgl-container",vdom:{tag:"d3fc-group","auto-resize":!0,cn:[]}},{module:r.Z,flex:"none",items:[{handler:"onStopAnimationButtonClick",text:"Stop Animation"},{handler:"onStopMainButtonClick",style:{marginLeft:".2em"},text:"Stop Main"},{handler:"changeItemAmount",pressed:!0,style:{marginLeft:"2em"},text:`${1e4.toLocaleString()} items`,toggleGroup:"itemAmount",value:1e4},{handler:"changeItemAmount",style:{marginLeft:".2em"},text:`${1e5.toLocaleString()} items`,toggleGroup:"itemAmount",value:1e5},{handler:"changeItemAmount",style:{marginLeft:".2em"},text:`${1e6.toLocaleString()} items`,toggleGroup:"itemAmount",value:1e6},{module:o.Z,reference:"time-label",style:{marginLeft:"2em"}},{handler:"moveCanvas",style:{marginLeft:"auto"},text:"Move Canvas"}]}],layout:{ntype:"vbox",align:"stretch"}}}afterSetMounted(e,t){super.afterSetMounted(e,t),e&&setInterval((()=>{this.down({reference:"time-label"}).text=`Time: ${this.getTime()}`}),1e3)}getTime(){return(new Date).toLocaleString(Neo.config.locale,{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}Neo.applyClassConfig(u);const h=()=>Neo.app({mainView:u,name:"MainApp"})}}]);
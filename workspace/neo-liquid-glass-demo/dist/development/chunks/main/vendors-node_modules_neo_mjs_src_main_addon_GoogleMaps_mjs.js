"use strict";
(self["webpackChunkmyapp"] = self["webpackChunkmyapp"] || []).push([["vendors-node_modules_neo_mjs_src_main_addon_GoogleMaps_mjs"],{

/***/ "./node_modules/neo.mjs/src/main/addon/Base.mjs":
/*!******************************************************!*\
  !*** ./node_modules/neo.mjs/src/main/addon/Base.mjs ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _core_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/Base.mjs */ "./node_modules/neo.mjs/src/core/Base.mjs");


/**
 * Base class for main thread addons
 * @class Neo.main.addon.Base
 * @extends Neo.core.Base
 */
class Base extends _core_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.main.addon.Base'
         * @protected
         */
        className: 'Neo.main.addon.Base',
        /**
         * An identifier for core.Base to get handled like singletons for remote method access
         * @member {Boolean} isMainThreadAddon=true
         * @protected
         */
        isMainThreadAddon: true,
        /**
         * Will get set to true once all addon related files got loaded (if there is a need to load)
         * @member {Boolean} isReady_=false
         * @protected
         */
        isReady_: false,
        /**
         * Amount in ms to delay the loading of library files, unless remote method access happens
         * Change the value to false in case you don't want an automated preloading
         * @member {Boolean|Number} preloadFilesDelay=5000
         * @protected
         */
        preloadFilesDelay: 5000,
    }

    /**
     * @member {Object[]} cache=[]
     */
    cache = []
    /**
     * Will get set to true once we start loading Monaco related files
     * @member {Boolean} isLoading=false
     */
    isLoading = false
    /**
     * Internal flag to store the setTimeout() id for loading external files
     * @member {Number|null} loadingTimeoutId=null
     */
    loadingTimeoutId = null

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        let me = this;

        if (me.loadFiles) {
            if (me.preloadFilesDelay === 0) {
                me.loadFiles()
            } else if (Neo.isNumber(me.preloadFilesDelay)) {
                me.loadingTimeoutId = setTimeout(() => {
                    me.loadFiles()
                }, me.preloadFilesDelay)
            }
        }
    }

    /**
     * Triggered after the isReady config got changed
     * @param {Boolean} value
     * @param {Boolean} oldValue
     * @protected
     */
    afterSetIsReady(value, oldValue) {
        if (value) {
            let me = this,
                returnValue;

            me.cache.forEach(item => {
                returnValue = me[item.fn](item.data);
                item.resolve(returnValue)
            });

            me.cache = []
        }
    }

    /**
     * Internally caches call when isReady===false
     * Loads the library files in case this is not already happening
     * @param item
     * @returns {Promise<unknown>}
     */
    cacheMethodCall(item) {
        let me = this;

        if (!me.isLoading) {
            me.loadingTimeoutId && clearTimeout(me.loadingTimeoutId);
            me.loadingTimeoutId = null;
            me.loadFiles()
        }

        return new Promise((resolve, reject) => {
            me.cache.push({...item, resolve})
        })
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Base));


/***/ }),

/***/ "./node_modules/neo.mjs/src/main/addon/GoogleMaps.mjs":
/*!************************************************************!*\
  !*** ./node_modules/neo.mjs/src/main/addon/GoogleMaps.mjs ***!
  \************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Base.mjs */ "./node_modules/neo.mjs/src/main/addon/Base.mjs");
/* harmony import */ var _DomAccess_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../DomAccess.mjs */ "./node_modules/neo.mjs/src/main/DomAccess.mjs");
/* harmony import */ var _DomEvents_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../DomEvents.mjs */ "./node_modules/neo.mjs/src/main/DomEvents.mjs");
/* harmony import */ var _core_Observable_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/Observable.mjs */ "./node_modules/neo.mjs/src/core/Observable.mjs");





/**
 * @class Neo.main.addon.GoogleMaps
 * @extends Neo.main.addon.Base
 */
class GoogleMaps extends _Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.main.addon.GoogleMaps'
         * @protected
         */
        className: 'Neo.main.addon.GoogleMaps',
        /**
         * @member {Neo.core.Base[]} mixins=[Observable]
         */
        mixins: [_core_Observable_mjs__WEBPACK_IMPORTED_MODULE_3__["default"]],
        /**
         * @member {Object} remote
         * @protected
         */
        remote: {
            app: [
                'addMarker',
                'create',
                'destroyMarkers',
                'geocode',
                'hideMarker',
                'panTo',
                'removeMap',
                'removeMarker',
                'setCenter',
                'setZoom',
                'showMarker'
            ]
        }
    }

    /**
     * @member {google.maps.Geocoder|null} maps=null
     */
    geoCoder = null
    /**
     * @member {Object} maps={}
     */
    maps = {}
    /**
     * @member {Object} markers={}
     */
    markers = {}

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);
        this.loadApi()
    }

    /**
     * @param {Object} data
     * @param {Object} [data.anchorPoint] x & y
     * @param {String} [data.icon]
     * @param {String} data.id
     * @param {String} [data.label]
     * @param {String} data.mapId
     * @param {Object} data.position
     * @param {String} [data.title]
     */
    addMarker(data) {
        let me      = this,
            {mapId} = data,
            listenerId, marker;

        if (!me.maps[mapId]) {
            listenerId = me.on('mapCreated', id => {
                if (mapId === id) {
                    me.un(listenerId);
                    me.addMarker(data)
                }
            })
        } else {
            Neo.ns(`${mapId}`, true, me.markers);

            me.markers[mapId][data.id] = marker = new google.maps.Marker({
                icon    : data.icon,
                label   : data.label,
                map     : me.maps[mapId],
                neoId   : data.id, // custom property
                neoMapId: mapId,   // custom property
                position: data.position,
                title   : data.title,
            });

            marker.addListener('click', me.onMarkerClick.bind(me, marker))
        }
    }

    /**
     * @param {Object} data
     * @param {Object} data.center
     * @param {Boolean} data.fullscreenControl
     * @param {String} data.id
     * @param {Object} data.mapOptions // Pass any options which are not explicitly defined here
     * @param {Number} data.maxZoom
     * @param {Number} data.minZoom
     * @param {Number} data.zoom
     * @param {Boolean} data.zoomControl
     */
    create(data) {
        let me   = this,
            {id} = data,
            map;

        me.maps[id] = map = new google.maps.Map(_DomAccess_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getElement(id), {
            center           : data.center,
            fullscreenControl: data.fullscreenControl,
            maxZoom          : data.maxZoom,
            minZoom          : data.minZoom,
            zoom             : data.zoom,
            zoomControl      : data.zoomControl,
            ...data.mapOptions
        });

        map.addListener('zoom_changed', me.onMapZoomChange.bind(me, map, id));

        me.fire('mapCreated', id)
    }

    /**
     * Destroys all markers for the specified map ID.
     * @param {Object} data
     * @param {String} data.mapId
     */
    destroyMarkers(data) {
        let me      = this,
            markers = me.markers[data.mapId] || {};

        Object.values(markers).forEach(marker => marker.setMap(null));
        delete me.markers[data.mapId]
    }

    /**
     * Use either address, location or placeId
     * @param {Object} data
     * @param {String} data.address
     * @param {Object} data.location
     * @param {String} data.placeId
     * @returns {Object}
     */
    async geocode(data) {
        let me = this,
            response;

        if (!me.geoCoder) {
            me.geoCoder = new google.maps.Geocoder()
        }

        response = await me.geoCoder.geocode(data);

        return JSON.parse(JSON.stringify(response))
    }

    /**
     * @param {Object} data
     * @param {String} data.id
     * @param {String} data.mapId
     */
    hideMarker(data) {
        this.markers[data.mapId][data.id].setMap(null)
    }

    /**
     * @protected
     */
    loadApi() {
        let key = Neo.config.googleMapsApiKey,
            url = ' https://maps.googleapis.com/maps/api/js';

        _DomAccess_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].loadScript(`${url}?key=${key}&v=weekly&callback=Neo.emptyFn`).then(() => {
            console.log('GoogleMaps API loaded')
        })
    }

    /**
     * @param {google.maps.Map} map
     * @param {String} mapId
     */
    onMapZoomChange(map, mapId) {
        _DomEvents_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].sendMessageToApp({
            id   : mapId,
            path : [{cls: [], id: mapId}],
            type : 'googleMapZoomChange',
            value: map.zoom
        })
    }

    /**
     * @param {google.maps.Marker} marker
     * @param {Object} event
     * @param {Object} event.domEvent
     */
    onMarkerClick(marker, event) {
        let transformedEvent = _DomEvents_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getMouseEventData(event.domEvent);

        _DomEvents_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].sendMessageToApp({
            id      : marker.neoId,
            path    : [{cls: [], id: marker.neoMapId}],
            type    : 'googleMarkerClick',
            domEvent: transformedEvent
        })
    }

    /**
     * @param data
     * @param {String} data.mapId
     * @param {Object} data.position
     */
    panTo(data) {
        this.maps[data.mapId].panTo(data.position)
    }

    /**
     * @param {Object} data
     * @param {String} data.mapId
     */
    removeMap(data) {
        delete this.maps[data.mapId];
        delete this.markers[data.mapId]
    }

    /**
     * @param {Object} data
     * @param {String} data.id
     * @param {String} data.mapId
     */
    removeMarker(data) {
        let markers = this.markers[data.mapId];

        markers[data.id].setMap(null);
        delete markers[data.id]
    }

    /**
     * @param {Object} data
     * @param {String} data.id
     * @param {Object} data.value
     */
    setCenter(data) {
        this.maps[data.id].setCenter(data.value)
    }

    /**
     * @param {Object} data
     * @param {String} data.id
     * @param {Number} data.value
     */
    setZoom(data) {
        this.maps[data.id].setZoom(data.value)
    }

    /**
     * @param {Object} data
     * @param {String} data.id
     * @param {String} data.mapId
     */
    showMarker(data) {
        this.markers[data.mapId][data.id].setMap(this.maps[data.mapId])
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(GoogleMaps));


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL21haW4vdmVuZG9ycy1ub2RlX21vZHVsZXNfbmVvX21qc19zcmNfbWFpbl9hZGRvbl9Hb29nbGVNYXBzX21qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUEyQzs7QUFFM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixzREFBUTtBQUMzQjtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsU0FBUztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsZ0JBQWdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixhQUFhO0FBQzdCO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZSxTQUFTO0FBQ3hCLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyQkFBMkIsaUJBQWlCO0FBQzVDLFNBQVM7QUFDVDtBQUNBOztBQUVBLGlFQUFlLG9CQUFvQixFQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDOUdBO0FBQ007QUFDQTtBQUNTOztBQUVuRDtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUVBQWUsMEJBQTBCLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teWFwcC8uL25vZGVfbW9kdWxlcy9uZW8ubWpzL3NyYy9tYWluL2FkZG9uL0Jhc2UubWpzIiwid2VicGFjazovL215YXBwLy4vbm9kZV9tb2R1bGVzL25lby5tanMvc3JjL21haW4vYWRkb24vR29vZ2xlTWFwcy5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENvcmVCYXNlIGZyb20gJy4uLy4uL2NvcmUvQmFzZS5tanMnO1xuXG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIG1haW4gdGhyZWFkIGFkZG9uc1xuICogQGNsYXNzIE5lby5tYWluLmFkZG9uLkJhc2VcbiAqIEBleHRlbmRzIE5lby5jb3JlLkJhc2VcbiAqL1xuY2xhc3MgQmFzZSBleHRlbmRzIENvcmVCYXNlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5tYWluLmFkZG9uLkJhc2UnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5tYWluLmFkZG9uLkJhc2UnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQW4gaWRlbnRpZmllciBmb3IgY29yZS5CYXNlIHRvIGdldCBoYW5kbGVkIGxpa2Ugc2luZ2xldG9ucyBmb3IgcmVtb3RlIG1ldGhvZCBhY2Nlc3NcbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gaXNNYWluVGhyZWFkQWRkb249dHJ1ZVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBpc01haW5UaHJlYWRBZGRvbjogdHJ1ZSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdpbGwgZ2V0IHNldCB0byB0cnVlIG9uY2UgYWxsIGFkZG9uIHJlbGF0ZWQgZmlsZXMgZ290IGxvYWRlZCAoaWYgdGhlcmUgaXMgYSBuZWVkIHRvIGxvYWQpXG4gICAgICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IGlzUmVhZHlfPWZhbHNlXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGlzUmVhZHlfOiBmYWxzZSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFtb3VudCBpbiBtcyB0byBkZWxheSB0aGUgbG9hZGluZyBvZiBsaWJyYXJ5IGZpbGVzLCB1bmxlc3MgcmVtb3RlIG1ldGhvZCBhY2Nlc3MgaGFwcGVuc1xuICAgICAgICAgKiBDaGFuZ2UgdGhlIHZhbHVlIHRvIGZhbHNlIGluIGNhc2UgeW91IGRvbid0IHdhbnQgYW4gYXV0b21hdGVkIHByZWxvYWRpbmdcbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbnxOdW1iZXJ9IHByZWxvYWRGaWxlc0RlbGF5PTUwMDBcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgcHJlbG9hZEZpbGVzRGVsYXk6IDUwMDAsXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7T2JqZWN0W119IGNhY2hlPVtdXG4gICAgICovXG4gICAgY2FjaGUgPSBbXVxuICAgIC8qKlxuICAgICAqIFdpbGwgZ2V0IHNldCB0byB0cnVlIG9uY2Ugd2Ugc3RhcnQgbG9hZGluZyBNb25hY28gcmVsYXRlZCBmaWxlc1xuICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IGlzTG9hZGluZz1mYWxzZVxuICAgICAqL1xuICAgIGlzTG9hZGluZyA9IGZhbHNlXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgZmxhZyB0byBzdG9yZSB0aGUgc2V0VGltZW91dCgpIGlkIGZvciBsb2FkaW5nIGV4dGVybmFsIGZpbGVzXG4gICAgICogQG1lbWJlciB7TnVtYmVyfG51bGx9IGxvYWRpbmdUaW1lb3V0SWQ9bnVsbFxuICAgICAqL1xuICAgIGxvYWRpbmdUaW1lb3V0SWQgPSBudWxsXG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0KGNvbmZpZykge1xuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcblxuICAgICAgICBsZXQgbWUgPSB0aGlzO1xuXG4gICAgICAgIGlmIChtZS5sb2FkRmlsZXMpIHtcbiAgICAgICAgICAgIGlmIChtZS5wcmVsb2FkRmlsZXNEZWxheSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIG1lLmxvYWRGaWxlcygpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKE5lby5pc051bWJlcihtZS5wcmVsb2FkRmlsZXNEZWxheSkpIHtcbiAgICAgICAgICAgICAgICBtZS5sb2FkaW5nVGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG1lLmxvYWRGaWxlcygpXG4gICAgICAgICAgICAgICAgfSwgbWUucHJlbG9hZEZpbGVzRGVsYXkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgYWZ0ZXIgdGhlIGlzUmVhZHkgY29uZmlnIGdvdCBjaGFuZ2VkXG4gICAgICogQHBhcmFtIHtCb29sZWFufSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gb2xkVmFsdWVcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYWZ0ZXJTZXRJc1JlYWR5KHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIGxldCBtZSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWU7XG5cbiAgICAgICAgICAgIG1lLmNhY2hlLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSBtZVtpdGVtLmZuXShpdGVtLmRhdGEpO1xuICAgICAgICAgICAgICAgIGl0ZW0ucmVzb2x2ZShyZXR1cm5WYWx1ZSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtZS5jYWNoZSA9IFtdXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbGx5IGNhY2hlcyBjYWxsIHdoZW4gaXNSZWFkeT09PWZhbHNlXG4gICAgICogTG9hZHMgdGhlIGxpYnJhcnkgZmlsZXMgaW4gY2FzZSB0aGlzIGlzIG5vdCBhbHJlYWR5IGhhcHBlbmluZ1xuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dW5rbm93bj59XG4gICAgICovXG4gICAgY2FjaGVNZXRob2RDYWxsKGl0ZW0pIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcztcblxuICAgICAgICBpZiAoIW1lLmlzTG9hZGluZykge1xuICAgICAgICAgICAgbWUubG9hZGluZ1RpbWVvdXRJZCAmJiBjbGVhclRpbWVvdXQobWUubG9hZGluZ1RpbWVvdXRJZCk7XG4gICAgICAgICAgICBtZS5sb2FkaW5nVGltZW91dElkID0gbnVsbDtcbiAgICAgICAgICAgIG1lLmxvYWRGaWxlcygpXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgbWUuY2FjaGUucHVzaCh7Li4uaXRlbSwgcmVzb2x2ZX0pXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhCYXNlKTtcbiIsImltcG9ydCBCYXNlICAgICAgIGZyb20gJy4vQmFzZS5tanMnO1xuaW1wb3J0IERvbUFjY2VzcyAgZnJvbSAnLi4vRG9tQWNjZXNzLm1qcyc7XG5pbXBvcnQgRG9tRXZlbnRzICBmcm9tICcuLi9Eb21FdmVudHMubWpzJztcbmltcG9ydCBPYnNlcnZhYmxlIGZyb20gJy4uLy4uL2NvcmUvT2JzZXJ2YWJsZS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8ubWFpbi5hZGRvbi5Hb29nbGVNYXBzXG4gKiBAZXh0ZW5kcyBOZW8ubWFpbi5hZGRvbi5CYXNlXG4gKi9cbmNsYXNzIEdvb2dsZU1hcHMgZXh0ZW5kcyBCYXNlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5tYWluLmFkZG9uLkdvb2dsZU1hcHMnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5tYWluLmFkZG9uLkdvb2dsZU1hcHMnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7TmVvLmNvcmUuQmFzZVtdfSBtaXhpbnM9W09ic2VydmFibGVdXG4gICAgICAgICAqL1xuICAgICAgICBtaXhpbnM6IFtPYnNlcnZhYmxlXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gcmVtb3RlXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHJlbW90ZToge1xuICAgICAgICAgICAgYXBwOiBbXG4gICAgICAgICAgICAgICAgJ2FkZE1hcmtlcicsXG4gICAgICAgICAgICAgICAgJ2NyZWF0ZScsXG4gICAgICAgICAgICAgICAgJ2Rlc3Ryb3lNYXJrZXJzJyxcbiAgICAgICAgICAgICAgICAnZ2VvY29kZScsXG4gICAgICAgICAgICAgICAgJ2hpZGVNYXJrZXInLFxuICAgICAgICAgICAgICAgICdwYW5UbycsXG4gICAgICAgICAgICAgICAgJ3JlbW92ZU1hcCcsXG4gICAgICAgICAgICAgICAgJ3JlbW92ZU1hcmtlcicsXG4gICAgICAgICAgICAgICAgJ3NldENlbnRlcicsXG4gICAgICAgICAgICAgICAgJ3NldFpvb20nLFxuICAgICAgICAgICAgICAgICdzaG93TWFya2VyJ1xuICAgICAgICAgICAgXVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7Z29vZ2xlLm1hcHMuR2VvY29kZXJ8bnVsbH0gbWFwcz1udWxsXG4gICAgICovXG4gICAgZ2VvQ29kZXIgPSBudWxsXG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7T2JqZWN0fSBtYXBzPXt9XG4gICAgICovXG4gICAgbWFwcyA9IHt9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7T2JqZWN0fSBtYXJrZXJzPXt9XG4gICAgICovXG4gICAgbWFya2VycyA9IHt9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0KGNvbmZpZykge1xuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcbiAgICAgICAgdGhpcy5sb2FkQXBpKClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbZGF0YS5hbmNob3JQb2ludF0geCAmIHlcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2RhdGEuaWNvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5pZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbZGF0YS5sYWJlbF1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5tYXBJZFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhLnBvc2l0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtkYXRhLnRpdGxlXVxuICAgICAqL1xuICAgIGFkZE1hcmtlcihkYXRhKSB7XG4gICAgICAgIGxldCBtZSAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHttYXBJZH0gPSBkYXRhLFxuICAgICAgICAgICAgbGlzdGVuZXJJZCwgbWFya2VyO1xuXG4gICAgICAgIGlmICghbWUubWFwc1ttYXBJZF0pIHtcbiAgICAgICAgICAgIGxpc3RlbmVySWQgPSBtZS5vbignbWFwQ3JlYXRlZCcsIGlkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobWFwSWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lLnVuKGxpc3RlbmVySWQpO1xuICAgICAgICAgICAgICAgICAgICBtZS5hZGRNYXJrZXIoZGF0YSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgTmVvLm5zKGAke21hcElkfWAsIHRydWUsIG1lLm1hcmtlcnMpO1xuXG4gICAgICAgICAgICBtZS5tYXJrZXJzW21hcElkXVtkYXRhLmlkXSA9IG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIGljb24gICAgOiBkYXRhLmljb24sXG4gICAgICAgICAgICAgICAgbGFiZWwgICA6IGRhdGEubGFiZWwsXG4gICAgICAgICAgICAgICAgbWFwICAgICA6IG1lLm1hcHNbbWFwSWRdLFxuICAgICAgICAgICAgICAgIG5lb0lkICAgOiBkYXRhLmlkLCAvLyBjdXN0b20gcHJvcGVydHlcbiAgICAgICAgICAgICAgICBuZW9NYXBJZDogbWFwSWQsICAgLy8gY3VzdG9tIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGRhdGEucG9zaXRpb24sXG4gICAgICAgICAgICAgICAgdGl0bGUgICA6IGRhdGEudGl0bGUsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbWFya2VyLmFkZExpc3RlbmVyKCdjbGljaycsIG1lLm9uTWFya2VyQ2xpY2suYmluZChtZSwgbWFya2VyKSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEuY2VudGVyXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBkYXRhLmZ1bGxzY3JlZW5Db250cm9sXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEuaWRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YS5tYXBPcHRpb25zIC8vIFBhc3MgYW55IG9wdGlvbnMgd2hpY2ggYXJlIG5vdCBleHBsaWNpdGx5IGRlZmluZWQgaGVyZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBkYXRhLm1heFpvb21cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZGF0YS5taW5ab29tXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGRhdGEuem9vbVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gZGF0YS56b29tQ29udHJvbFxuICAgICAqL1xuICAgIGNyZWF0ZShkYXRhKSB7XG4gICAgICAgIGxldCBtZSAgID0gdGhpcyxcbiAgICAgICAgICAgIHtpZH0gPSBkYXRhLFxuICAgICAgICAgICAgbWFwO1xuXG4gICAgICAgIG1lLm1hcHNbaWRdID0gbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChEb21BY2Nlc3MuZ2V0RWxlbWVudChpZCksIHtcbiAgICAgICAgICAgIGNlbnRlciAgICAgICAgICAgOiBkYXRhLmNlbnRlcixcbiAgICAgICAgICAgIGZ1bGxzY3JlZW5Db250cm9sOiBkYXRhLmZ1bGxzY3JlZW5Db250cm9sLFxuICAgICAgICAgICAgbWF4Wm9vbSAgICAgICAgICA6IGRhdGEubWF4Wm9vbSxcbiAgICAgICAgICAgIG1pblpvb20gICAgICAgICAgOiBkYXRhLm1pblpvb20sXG4gICAgICAgICAgICB6b29tICAgICAgICAgICAgIDogZGF0YS56b29tLFxuICAgICAgICAgICAgem9vbUNvbnRyb2wgICAgICA6IGRhdGEuem9vbUNvbnRyb2wsXG4gICAgICAgICAgICAuLi5kYXRhLm1hcE9wdGlvbnNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbWFwLmFkZExpc3RlbmVyKCd6b29tX2NoYW5nZWQnLCBtZS5vbk1hcFpvb21DaGFuZ2UuYmluZChtZSwgbWFwLCBpZCkpO1xuXG4gICAgICAgIG1lLmZpcmUoJ21hcENyZWF0ZWQnLCBpZClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyBhbGwgbWFya2VycyBmb3IgdGhlIHNwZWNpZmllZCBtYXAgSUQuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5tYXBJZFxuICAgICAqL1xuICAgIGRlc3Ryb3lNYXJrZXJzKGRhdGEpIHtcbiAgICAgICAgbGV0IG1lICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgbWFya2VycyA9IG1lLm1hcmtlcnNbZGF0YS5tYXBJZF0gfHwge307XG5cbiAgICAgICAgT2JqZWN0LnZhbHVlcyhtYXJrZXJzKS5mb3JFYWNoKG1hcmtlciA9PiBtYXJrZXIuc2V0TWFwKG51bGwpKTtcbiAgICAgICAgZGVsZXRlIG1lLm1hcmtlcnNbZGF0YS5tYXBJZF1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVc2UgZWl0aGVyIGFkZHJlc3MsIGxvY2F0aW9uIG9yIHBsYWNlSWRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLmFkZHJlc3NcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YS5sb2NhdGlvblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLnBsYWNlSWRcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqL1xuICAgIGFzeW5jIGdlb2NvZGUoZGF0YSkge1xuICAgICAgICBsZXQgbWUgPSB0aGlzLFxuICAgICAgICAgICAgcmVzcG9uc2U7XG5cbiAgICAgICAgaWYgKCFtZS5nZW9Db2Rlcikge1xuICAgICAgICAgICAgbWUuZ2VvQ29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKVxuICAgICAgICB9XG5cbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBtZS5nZW9Db2Rlci5nZW9jb2RlKGRhdGEpO1xuXG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLmlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEubWFwSWRcbiAgICAgKi9cbiAgICBoaWRlTWFya2VyKGRhdGEpIHtcbiAgICAgICAgdGhpcy5tYXJrZXJzW2RhdGEubWFwSWRdW2RhdGEuaWRdLnNldE1hcChudWxsKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBsb2FkQXBpKCkge1xuICAgICAgICBsZXQga2V5ID0gTmVvLmNvbmZpZy5nb29nbGVNYXBzQXBpS2V5LFxuICAgICAgICAgICAgdXJsID0gJyBodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvanMnO1xuXG4gICAgICAgIERvbUFjY2Vzcy5sb2FkU2NyaXB0KGAke3VybH0/a2V5PSR7a2V5fSZ2PXdlZWtseSZjYWxsYmFjaz1OZW8uZW1wdHlGbmApLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0dvb2dsZU1hcHMgQVBJIGxvYWRlZCcpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtnb29nbGUubWFwcy5NYXB9IG1hcFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtYXBJZFxuICAgICAqL1xuICAgIG9uTWFwWm9vbUNoYW5nZShtYXAsIG1hcElkKSB7XG4gICAgICAgIERvbUV2ZW50cy5zZW5kTWVzc2FnZVRvQXBwKHtcbiAgICAgICAgICAgIGlkICAgOiBtYXBJZCxcbiAgICAgICAgICAgIHBhdGggOiBbe2NsczogW10sIGlkOiBtYXBJZH1dLFxuICAgICAgICAgICAgdHlwZSA6ICdnb29nbGVNYXBab29tQ2hhbmdlJyxcbiAgICAgICAgICAgIHZhbHVlOiBtYXAuem9vbVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Z29vZ2xlLm1hcHMuTWFya2VyfSBtYXJrZXJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnQuZG9tRXZlbnRcbiAgICAgKi9cbiAgICBvbk1hcmtlckNsaWNrKG1hcmtlciwgZXZlbnQpIHtcbiAgICAgICAgbGV0IHRyYW5zZm9ybWVkRXZlbnQgPSBEb21FdmVudHMuZ2V0TW91c2VFdmVudERhdGEoZXZlbnQuZG9tRXZlbnQpO1xuXG4gICAgICAgIERvbUV2ZW50cy5zZW5kTWVzc2FnZVRvQXBwKHtcbiAgICAgICAgICAgIGlkICAgICAgOiBtYXJrZXIubmVvSWQsXG4gICAgICAgICAgICBwYXRoICAgIDogW3tjbHM6IFtdLCBpZDogbWFya2VyLm5lb01hcElkfV0sXG4gICAgICAgICAgICB0eXBlICAgIDogJ2dvb2dsZU1hcmtlckNsaWNrJyxcbiAgICAgICAgICAgIGRvbUV2ZW50OiB0cmFuc2Zvcm1lZEV2ZW50XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGRhdGFcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5tYXBJZFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhLnBvc2l0aW9uXG4gICAgICovXG4gICAgcGFuVG8oZGF0YSkge1xuICAgICAgICB0aGlzLm1hcHNbZGF0YS5tYXBJZF0ucGFuVG8oZGF0YS5wb3NpdGlvbilcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLm1hcElkXG4gICAgICovXG4gICAgcmVtb3ZlTWFwKGRhdGEpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMubWFwc1tkYXRhLm1hcElkXTtcbiAgICAgICAgZGVsZXRlIHRoaXMubWFya2Vyc1tkYXRhLm1hcElkXVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEuaWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5tYXBJZFxuICAgICAqL1xuICAgIHJlbW92ZU1hcmtlcihkYXRhKSB7XG4gICAgICAgIGxldCBtYXJrZXJzID0gdGhpcy5tYXJrZXJzW2RhdGEubWFwSWRdO1xuXG4gICAgICAgIG1hcmtlcnNbZGF0YS5pZF0uc2V0TWFwKG51bGwpO1xuICAgICAgICBkZWxldGUgbWFya2Vyc1tkYXRhLmlkXVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEuaWRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YS52YWx1ZVxuICAgICAqL1xuICAgIHNldENlbnRlcihkYXRhKSB7XG4gICAgICAgIHRoaXMubWFwc1tkYXRhLmlkXS5zZXRDZW50ZXIoZGF0YS52YWx1ZSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLmlkXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGRhdGEudmFsdWVcbiAgICAgKi9cbiAgICBzZXRab29tKGRhdGEpIHtcbiAgICAgICAgdGhpcy5tYXBzW2RhdGEuaWRdLnNldFpvb20oZGF0YS52YWx1ZSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLmlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEubWFwSWRcbiAgICAgKi9cbiAgICBzaG93TWFya2VyKGRhdGEpIHtcbiAgICAgICAgdGhpcy5tYXJrZXJzW2RhdGEubWFwSWRdW2RhdGEuaWRdLnNldE1hcCh0aGlzLm1hcHNbZGF0YS5tYXBJZF0pXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhHb29nbGVNYXBzKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==
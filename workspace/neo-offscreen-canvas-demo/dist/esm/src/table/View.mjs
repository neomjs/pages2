import e from"../component/Base.mjs";class t extends e{static getConfig(){return{className:"Neo.table.View",ntype:"table-view",cls:["neo-table-view"],containerId:null,recordVnodeMap:{},store:null,useRowRecordIds:!0,_vdom:{tag:"tbody",cn:[]}}}createViewData(e){let t,o,l,d,r,n,s,i,a,c,g,p,h,m,u=this,y=e.length,f=Neo.getComponent(u.parentId),I=f.store?.model,w=f.items[0].items,b=w.length,N=[],C=0,M=u.vdom;for(u.recordVnodeMap={},"selection-table-rowmodel"===f.selectionModel.ntype&&(h=f.selectionModel.items||[]);C<y;C++){for(g=e[C],s=u.getRowId(g,C),u.recordVnodeMap[s]=C,m=u.getTrClass(g,C),h?.includes(s)&&(m.push("neo-selected"),Neo.getComponent(u.containerId).fire("select",{record:g})),N.push({tag:"tr",id:s,cls:m,cn:[],tabIndex:"-1"}),r=0,n=0,a=0;a<b;a++)d=w[a],p=g[d.dataField],void 0===p&&(p=""),c=d.renderer.call(d.rendererScope||f,{dataField:d.dataField,index:C,record:g,value:p}),t=c.cls||["neo-table-cell"],"left"!==d.align&&t.push("neo-"+d.align),Neo.isObject(c)||(c={cls:t,html:c.toString()}),o=I?u.getCellId(g,d.dataField):M.cn[C]?.cn[a]?.id||Neo.getId("td"),l={tag:"td",id:o,cls:c.cls||["neo-table-cell"],innerHTML:c.html||"",style:c.style||{},tabIndex:"-1"},d.dock&&(l.cls=["neo-locked",...l.cls||[]],"left"===d.dock&&(l.style.left=r+"px",r+=d.width+1)),N[C].cn.push(l);for(a=0;a<b;a++)i=b-a-1,d=w[i],"right"===d.dock&&(N[C].cn[i].style.right=n+"px",n+=d.width+1)}M.cn=N,f.dockLeftMargin=r,f.dockRightMargin=n,u.promiseVdomUpdate().then((()=>{h?.length>0&&Neo.main.DomAccess.scrollToTableRow({id:h[0]})}))}destroy(e,t){this.store=null,super.destroy(e,t)}getCellId(e,t){return this.id+"__"+e[this.store.keyProperty]+"__"+t}getRecordByRowId(e){return this.store.getAt(this.recordVnodeMap[e])}getRowId(e,t){let o=this,l=o.store;return o.useRowRecordIds?`${o.id}__tr__${e[l.keyProperty]}`:(t=Neo.isNumber(t)?t:l.indexOf(e),o.vdom.cn[t]?.id||Neo.getId("tr"))}getTrClass(e,t){return["neo-table-row"]}onStoreRecordChange(e){let t,o,l=this,d=[];e.fields.forEach((r=>{t=l.getCellId(e.record,r.name),o=l.getVdomChild(t),o.innerHTML=r.value,d.push({id:t,innerHTML:r.value})})),d.length>0&&Neo.applyDeltas(l.appName,d)}}Neo.applyClassConfig(t);export{t as default};
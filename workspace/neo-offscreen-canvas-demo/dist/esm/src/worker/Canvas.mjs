import e from"../Neo.mjs";import s from"./Base.mjs";import*as o from"../core/_export.mjs";class r extends s{static getConfig(){return{className:"Neo.worker.Canvas",map:{},singleton:!0,workerId:"canvas"}}afterConnect(){let e=this,s=new MessageChannel,o=s.port2;s.port1.onmessage=e.onMessage.bind(e),e.sendMessage("app",{action:"registerPort",transfer:o},[o]),e.channelPorts.app=s.port1}onRegisterCanvas(s){this.map[s.nodeId]=s.node,e.currentWorker.sendMessage(s.origin,{action:"reply",replyId:s.id,success:!0})}onRegisterNeoConfig(s){super.onRegisterNeoConfig(s);let o=e.config.appPath.slice(0,-8);import(`../../${o}/canvas.mjs`).then((e=>{e.onStart()}))}}e.applyClassConfig(r);let a=e.create(r);e.applyToGlobalNs(a);export default a;
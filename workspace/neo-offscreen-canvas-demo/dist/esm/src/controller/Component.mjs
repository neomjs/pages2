import e from"./Base.mjs";import n from"../manager/Component.mjs";import t from"../manager/DomEvent.mjs";import r from"../core/Logger.mjs";class o extends e{static getConfig(){return{className:"Neo.controller.Component",ntype:"component-controller",component:null,parent_:null,references:null}}constructor(e){super(e);let n,t=this,r=t.component;t.references={},r.isConstructed?t.onComponentConstructed():n=r.on("constructed",(()=>{r.un("constructed",n),t.onComponentConstructed()}))}beforeSetParent(e,n){return e||this.getParent()}getHandlerScope(e){let n=this,t=n.parent;return Neo.isFunction(n[e])?n:t?t.getHandlerScope(e):null}getModel(e=!1){let n=this.component;return e?n.model:n.getModel()}getParent(){let e,n,t=this;return t.parent?t.parent:(n=t.component.parentId,e=n&&Neo.getComponent(n),e?.getController()||null)}getReference(e){let n=this,t=n.references[e];return t||(t=n.component.down({reference:e}),t&&(n.references[e]=t)),t||null}onComponentConstructed(){}parseConfig(e=this.component){let n,o,s,c=this,l=e.domListeners,a=e.listeners,i=e.reference;l&&l.forEach((l=>{Object.entries(l).forEach((([a,i])=>{n=null,"scope"!==a&&"delegate"!==a&&(Neo.isString(i)?n=i:Neo.isObject(i)&&i.hasOwnProperty("fn")&&Neo.isString(i.fn)&&(n=i.fn),n&&(s=c.getHandlerScope(n),s?(o=s[n].bind(s),l[a]=o,t.updateListenerPlaceholder({componentId:e.id,eventHandlerMethod:o,eventHandlerName:n,eventName:a,scope:undefined})):r.logError("Unknown domEvent handler for",n,e)))}))})),a&&Object.entries(a).forEach((([t,o])=>{"scope"!==t&&"delegate"!==t&&o.forEach((t=>{Neo.isObject(t)&&t.hasOwnProperty("fn")&&Neo.isString(t.fn)&&(n=t.fn,s=c.getHandlerScope(n),s?t.fn=s[n].bind(s):r.logError("Unknown event handler for",n,e))}))})),i&&(c.references[i]=e)}removeReference(e){let n,t=this.references;for(n in t)if(e===t[n]){delete t[n];break}}}Neo.applyClassConfig(o);export{o as default};
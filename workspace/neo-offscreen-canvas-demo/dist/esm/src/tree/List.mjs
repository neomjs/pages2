import e from"../list/Base.mjs";import t from"../collection/Base.mjs";import o from"../util/Array.mjs";class l extends e{static getConfig(){return{className:"Neo.tree.List",ntype:"treelist",cls:["neo-tree-list"],disableSelection:!0,dragZone:null,showCollapseExpandAllIcons:!0,sortable_:!1,sortZone:null,sortZoneConfig:null,_vdom:{cn:[{tag:"ul",cls:["neo-list-container","neo-list"],cn:[]}]}}}afterSetDraggable(e,t){let o=this;e&&(o.sortable?console.error("tree.List can be either draggable or sortable, not both.",o.id):o.dragZone||import("../draggable/tree/DragZone.mjs").then((e=>{o.dragZone=Neo.create({module:e.default,appName:o.appName,owner:o,...o.dragZoneConfig})})))}afterSetSortable(e,t){let o=this;e&&(o.draggable?console.error("tree.List can be either draggable or sortable, not both.",o.id):o.sortZone||import("../draggable/tree/SortZone.mjs").then((e=>{o.sortZone=Neo.create({module:e.default,appName:o.appName,boundaryContainerId:o.id,owner:o,...o.sortZoneConfig})})))}beforeSetStore(e,o){return e||(e=Neo.create(t,{keyProperty:"id"})),super.beforeSetStore(e,o)}collapseAll(e=!1){let t,l=this,n=l.vdom,s=!1;l.store.items.forEach((e=>{e.isLeaf||(t=l.getVdomChild(l.getItemId(e.id),n),t.cls.includes("neo-folder-open")&&(o.remove(t.cls,"neo-folder-open"),s=!0))})),s&&(l[e?"_vdom":"vdom"]=n)}createItems(e,t,o){let l,n,s=this,i=s.store.find("parentId",e);return i.length>0&&(t.cn||(t.cn=[]),null!==e?(t.cn.push({tag:"ul",cls:["neo-list"],cn:[],style:{paddingLeft:"15px"}}),n=t.cn[t.cn.length-1]):n=t,i.forEach((e=>{l=["neo-list-item"],e.isLeaf?l.push(e.singleton?"neo-list-item-leaf-singleton":"neo-list-item-leaf"):(l.push("neo-list-folder"),e.collapsed||l.push("neo-folder-open")),n.cn.push({tag:"li",cls:l,id:s.getItemId(e.id),cn:[{tag:"span",cls:["neo-list-item-content"],innerHTML:e.name,style:{pointerEvents:"none"}}],style:{padding:"10px",position:e.isLeaf?null:"sticky",top:e.isLeaf?null:38*o+"px",zIndex:e.isLeaf?null:20/(o+1)}}),n=s.createItems(e.id,n,o+1)}))),t}expandAll(e=!1){let t,l=this,n=l.vdom,s=!1;l.store.items.forEach((e=>{e.isLeaf||(t=l.getVdomChild(l.getItemId(e.id),n),t.cls.includes("neo-folder-open")||(o.add(t.cls,"neo-folder-open"),s=!0))})),s&&(l[e?"_vdom":"vdom"]=n)}filter(e,t,o,l=!1){let n,s,i,r=this,a=!0,d=new RegExp(t,"gi"),c=r.vdom;return t||(t=""),r.store.items.forEach((m=>{m.parentId===o&&(s=!1,i=r.getVdomChild(r.getItemId(m.id),c),i.cn[0].innerHTML=m[e].replace(d,(e=>(s=!0,`<span class="neo-highlight-search">${e}</span>`))),n=!!m.isLeaf||r.filter(e,t,m.id,s||l),(s||l||!1===n||""===t)&&(a=!1),i.style.display=a?"none":"list-item")})),null===o&&(r.expandAll(!0),r.vdom=c),a}getListItemsRoot(){return this.vdom.cn[this.showCollapseExpandAllIcons?2:0]}onClick(e){e.target.cls.includes("neo-treelist-menu-item")?this.onMenuItemClick(e.target.cls):super.onClick(e)}onConstructed(){super.onConstructed();let e=this,t=e.vdom;e.showCollapseExpandAllIcons&&(t.cn.unshift({cls:["neo-treelist-menu-item","neo-treelist-collapse-all-icon"],cn:[{tag:"span",cls:["neo-treelist-menu-item-content"]}]},{cls:["neo-treelist-menu-item","neo-treelist-expand-all-icon"],cn:[{tag:"span",cls:["neo-treelist-menu-item-content"]}]}),e.vdom=t)}onItemClick(e,t){let l,n,s,i,r=this,a=r.vdom,d=r.store.items,c=0,m=d.length,p=t.path.map((e=>e.id));for(;c<m;c++)if(s=d[c],i=r.getItemId(s.id),p.includes(i)){n=s,l=r.getVdomChild(i);break}l&&(l.cls?.includes("neo-list-folder")?(o.toggle(l.cls,"neo-folder-open"),r.vdom=a):(r.onLeafItemClick(n),r.fire("leafItemClick",n)),super.onItemClick(e,t))}onLeafItemClick(e){}onMenuItemClick(e){e.includes("neo-treelist-collapse-all-icon")?this.collapseAll():this.expandAll()}}Neo.applyClassConfig(l);export{l as default};
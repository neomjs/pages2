import e from"../core/Base.mjs";import s from"../util/Array.mjs";import t from"../core/Observable.mjs";class l extends e{static getStaticConfig(){return{observable:!0}}static getConfig(){return{className:"Neo.selection.Model",ntype:"selection-model",cls:null,items_:null,selectedCls:"neo-selected",singleSelect:!0,view_:null}}beforeGetItems(e){return e||(this._items=e=[]),e}beforeGetView(e){return Neo.getComponent(this._view)}beforeSetView(e){return e&&e.id}addDomListener(){}deselect(e,t,l,i){let r,o=this,c=o.view,d=c.vdom,m=c.getVdomChild(e);m&&(r=m.cls||[],s.remove(r,i||o.selectedCls),m.cls=r),s.remove(l||o.items,e),t||(c.vdom=d)}deselectAll(e){let s=this,t=[...s.items],l=s.view,i=l.vdom;t.forEach((e=>{s.deselect(e,!0)})),!e&&t.length>0&&(l.vdom=i)}destroy(){this.unregister(),super.destroy()}getSelection(){return this.items}hasSelection(){return this.items.length>0}isSelected(e){return this.items.includes(e)}register(e){let s=this,t=e.cls||[];s.cls&&!t.includes(s.cls)&&(t.push(s.cls),e.cls=t),s.view=e,s.addDomListener()}removeDomListeners(){let e=this,t=e.view,l=[...t.domListeners];t.domListeners.forEach((t=>{t.scope===e&&s.remove(l,t)})),t.domListeners=l}select(e,t,l){e=Array.isArray(e)?e:[e];let i,r=this,o=r.view,c=o.vdom;t=t||r.items,Neo.isEqual(t,e)||(r.singleSelect&&r.deselectAll(!0),e.forEach((e=>{"string"==typeof e&&(e=o.getVdomChild(e)),e&&(i=e.cls||[],s.add(i,l||r.selectedCls),e.cls=i)})),s.add(t,e),o[o.silentSelect?"_vdom":"vdom"]=c,o.onSelect?.(e))}toggleSelection(e){let s=this;s.isSelected(e)?s.deselect(e):s.select(e)}unregister(){let e=this,t=e.view.cls||[];e.cls&&t.includes(e.cls)&&(s.remove(t,e.cls),e.view.cls=t),e.deselectAll(),e.removeDomListeners()}}Neo.applyClassConfig(l);export{l as default};
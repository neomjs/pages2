import e from"../Model.mjs";import o from"../../util/VDom.mjs";class t extends e{static getConfig(){return{className:"Neo.selection.table.RowModel",ntype:"selection-table-rowmodel",cls:"neo-selection-rowmodel"}}addDomListener(){let e=this,o=e.view,t=o.domListeners;t.push({click:e.onRowClick,delegate:".neo-table-row",scope:e}),o.domListeners=t}getRowId(e){return e<0||this.view.store.getCount()<e?null:this.view.vdom.cn[0].cn[1].cn[e].id}static getRowNode(e){let o=0,t=e.length,s=null;for(;o<t;o++)e[o].cls.includes("neo-table-row")&&(s=e[o]);return s}onKeyDownDown(e){this.onNavKeyRow(e,1)}onKeyDownUp(e){this.onNavKeyRow(e,-1)}onNavKeyRow(e,s){let n,i=this,l=t.getRowNode(e.path),r=i.view,d=r.store,c=o.findVdomChild(r.vdom,l.id),w=(c.index+s)%d.getCount(),p=c.parentNode;for(;w<0;)w+=d.getCount();n=p.cn[w].id,n&&(i.select(n),r.focus(n),r.fire("select",{record:d.getAt(w)}))}onRowClick(e){let s,n,i=this,l=t.getRowNode(e.path),r=l&&l.id,d=i.view;r&&(i.toggleSelection(r),s=i.isSelected(r),n=d.store.getAt(o.findVdomChild(d.vdom,r).index),!s&&d.onDeselect?.(n),d.fire(s?"select":"deselect",{record:n}))}register(e){super.register(e);let o=this.id,t=this.view;t.keys&&t.keys._keys.push({fn:"onKeyDownDown",key:"Down",scope:o},{fn:"onKeyDownUp",key:"Up",scope:o})}unregister(){let e=this.id,o=this.view;o.keys&&o.keys.removeKeys([{fn:"onKeyDownDown",key:"Down",scope:e},{fn:"onKeyDownUp",key:"Up",scope:e}]),super.unregister()}}Neo.applyClassConfig(t);export{t as default};
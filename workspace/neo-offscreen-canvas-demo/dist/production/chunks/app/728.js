"use strict";(self.webpackChunkneo_offscreen_canvas_demo=self.webpackChunkneo_offscreen_canvas_demo||[]).push([[728],{728:(e,t,n)=>{n.r(t),n.d(t,{onStart:()=>g});var a=n(22),o=(n(99),n(738)),s=n(92),i=n(846);class r extends s.A{static dockPositions=["top","right","bottom","left",null];static config={className:"Neo.toolbar.Base",ntype:"toolbar",baseCls:["neo-toolbar"],dock_:null,itemDefaults:{ntype:"button"},layout:{ntype:"flexbox",align:"center",direction:"row",pack:"start"},sortable_:!1,sortZone:null,sortZoneConfig:null};afterSetAppName(e,t){super.afterSetAppName(e,t),this.sortZone&&(this.sortZone.appName=e)}afterSetDock(e,t){if(!e&&!t)return;let n=this,{cls:a}=n,o=n.getStaticConfig("dockPositions"),s=n.getLayoutConfig();o.forEach((t=>{null!==t&&i.A.toggle(a,"neo-dock-"+t,t===e)})),n.layout?(n.layout.set(s),n.cls=a):(s.ntype="flexbox",n.set({cls:a,layout:s}))}afterSetSortable(e,t){let a=this;e&&!a.sortZone&&n.e(556).then(n.bind(n,175)).then((e=>{a.sortZone=Neo.create({module:e.default,appName:a.appName,boundaryContainerId:a.id,owner:a,windowId:a.windowId,...a.sortZoneConfig})}))}afterSetWindowId(e,t){super.afterSetWindowId(e,t),this.sortZone&&(this.sortZone.windowId=e)}beforeSetDock(e,t){return this.beforeSetEnumValue(e,t,"dock","dockPositions")}createItems(){let e=this._items;return Array.isArray(e)&&(this._items=e.map((e=>this.replaceSpacer(e)))),super.createItems()}getLayoutConfig(){let e,t=this;if(t.dock)switch(t.dock){case"bottom":case"top":e={align:"center",direction:"row",pack:"start"};break;case"left":e={align:"center",direction:"column-reverse",pack:"start"};break;case"right":e={align:"center",direction:"column",pack:"start"}}return e||t.layout}insert(e,t,n=!1){return t=Array.isArray(t)?t.map((e=>this.replaceSpacer(e))):this.replaceSpacer(t),super.insert(e,t,n)}replaceSpacer(e){return"->"===e?{module:o.A,flex:1}:e}}const c=Neo.setupClass(r);var l=n(658);class p extends o.A{static getConfig(){return{className:"Neo.component.Canvas",ntype:"canvas",offscreen:!0,offscreenRegistered_:!1,_vdom:{tag:"canvas"}}}afterSetMounted(e,t){super.afterSetMounted(e,t);let n=this,a=n.getCanvasId(),o=Neo.currentWorker;e&&n.offscreen&&o.promiseMessage("main",{action:"getOffscreenCanvas",nodeId:a}).then((e=>{o.promiseMessage("canvas",{action:"registerCanvas",node:e.offscreen,nodeId:a},[e.offscreen]).then((()=>{n.offscreenRegistered=!0}))}))}getCanvasId(){return this.id}}Neo.applyClassConfig(p);const m=Neo.setupClass(class extends p{static config={className:"MyApp.view.WebGlComponent",_vdom:{tag:"d3fc-canvas",cn:[{tag:"canvas"}]}};afterSetId(e,t){this.vdom.cn[0].id=`${e}__canvas`,super.afterSetId(e,t)}afterSetOffscreenRegistered(e,t){if(e){let e=this,t=e.domListeners;t.push({measure:e.onMeasure,scope:e}),e.domListeners=t,setTimeout((()=>{MyApp.canvas.Helper.renderSeries(this.getCanvasId()),Neo.main.DomAccess.getBoundingClientRect({id:e.id}).then((t=>{e.updateSize(t.height,t.width)}))}),50)}}getCanvasId(){return this.vdom.cn[0].id}onMeasure(e){let t=e.path[0];this.updateSize(t.clientHeight,t.clientWidth)}updateSize(e,t){MyApp.canvas.Helper.updateSize({height:e,width:t})}});class d extends l.A{static config={className:"MyApp.view.MainContainer",autoMount:!0,layout:{ntype:"vbox",align:"stretch"}};construct(e){super.construct(e);let t=this;t.items=[{ntype:"container",flex:1,items:[m],layout:{ntype:"fit"},vdom:{tag:"d3fc-group","auto-resize":!0,cn:[]}},{module:c,flex:"none",items:[{handler:t.onStopAnimationButtonClick.bind(t),text:"Stop Animation"},{handler:t.onStopMainButtonClick.bind(t),style:{marginLeft:".2em"},text:"Stop Main"},{handler:t.changeItemAmount.bind(t,1e4),pressed:!0,style:{marginLeft:"2em"},text:`${1e4.toLocaleString()} items`,toggleGroup:"itemAmount",value:1e4},{handler:t.changeItemAmount.bind(t,1e5),style:{marginLeft:".2em"},text:`${1e5.toLocaleString()} items`,toggleGroup:"itemAmount",value:1e5},{handler:t.changeItemAmount.bind(t,1e6),style:{marginLeft:".2em"},text:`${1e6.toLocaleString()} items`,toggleGroup:"itemAmount",value:1e6},{module:a.A,reference:"time-label",style:{marginLeft:"2em"},text:`Time: ${t.getTime()}`}]}]}afterSetMounted(e,t){super.afterSetMounted(e,t),e&&setInterval((()=>{this.down({reference:"time-label"}).text=`Time: ${this.getTime()}`}),1e3)}changeItemAmount(e){MyApp.canvas.Helper.changeItemsAmount(e),this.items[1].items.forEach((t=>{"itemAmount"===t.toggleGroup&&(t.pressed=t.value===e)}))}getTime(){return(new Date).toLocaleString(Neo.config.locale,{hour:"2-digit",minute:"2-digit",second:"2-digit"})}onStopAnimationButtonClick(e){let t,n=!0;"Stop Animation"===e.component.text?(t="Start Animation",n=!1):t="Stop Animation",e.component.text=t,MyApp.canvas.Helper.enableAnimation(n)}onStopMainButtonClick(e){Neo.Main.alert(["This alert pauses the JS main thread.\n\n","Notice that the time inside the bottom toolbar has stopped updating.\n\n","Closing this alert will resume the main thread."].join(""))}}const u=Neo.setupClass(d),g=()=>Neo.app({appPath:"apps/myapp/",mainView:u,name:"MyApp"})}}]);
"use strict";(self.webpackChunkneo_offscreen_canvas_demo=self.webpackChunkneo_offscreen_canvas_demo||[]).push([[536],{6536:(e,t,n)=>{n.r(t),n.d(t,{onStart:()=>r});var a=n(3607);class s extends a.A{static config={className:"MyApp.canvas.Helper",singleton:!0,itemsAmount_:1e4,remote:{app:["changeItemsAmount","enableAnimation","renderSeries","updateSize"]},stopAnimation_:!1};canvasId=null;canvasSize=null;data=null;series=null;xScale=null;yScale=null;construct(e){super.construct(e);let t=this;t.promiseImportD3().then((()=>{t.xScale=d3.scaleLinear().domain([-5,5]),t.yScale=d3.scaleLinear().domain([-5,5]),t.generateData(),t.generateSeries(),t.canvasId&&(t.renderSeries(t.canvasId),t.updateSize(t.canvasSize))}))}afterSetItemsAmount(e,t){if(e&&Neo.isNumber(t)){let e=this;e.stopAnimation=!0,e.generateData(),e.generateSeries(),e.renderSeries(e.canvasId,!0),e.stopAnimation=!1}}afterSetStopAnimation(e,t){!e&&Neo.isBoolean(t)&&this.render()}changeItemsAmount(e){this.itemsAmount=e}enableAnimation(e){this.stopAnimation=!e}generateData(){let e=d3.randomNormal(0,1),t=d3.randomLogNormal();this.data=Array.from({length:this.itemsAmount},(()=>({x:e(),y:e(),size:10*t()})))}generateSeries(){let e=this,t=d3.scaleOrdinal(d3.schemeAccent),n=fc.seriesWebglPoint().xScale(e.xScale).yScale(e.yScale).crossValue((e=>e.x)).mainValue((e=>e.y)).size((e=>e.size)).equals((e=>e.length>0)),a=fc.webglFillColor().value(((e,n)=>(e=>{let{r:t,g:n,b:a,opacity:s}=d3.color(e).rgb();return[t/255,n/255,a/255,s]})(t(n)))).data(e.data);n.decorate((e=>a(e))),e.series=n}async promiseImportD3(){let e,t=[()=>n.e(397).then(n.bind(n,1397)),()=>n.e(529).then(n.bind(n,3529)),()=>n.e(179).then(n.bind(n,6179)),()=>n.e(941).then(n.bind(n,6941)),()=>n.e(617).then(n.bind(n,2617)),()=>n.e(71).then(n.bind(n,5071)),()=>n.e(973).then(n.bind(n,1973)),()=>n.e(477).then(n.bind(n,1477)),()=>n.e(401).then(n.bind(n,5401)),()=>Promise.all([n.e(56),n.e(33)]).then(n.t.bind(n,6669,19)),()=>n.e(355).then(n.t.bind(n,3355,19)),()=>n.e(169).then(n.t.bind(n,7169,19)),()=>Promise.all([n.e(497),n.e(56),n.e(297)]).then(n.t.bind(n,3297,19)),()=>Promise.all([n.e(497),n.e(333)]).then(n.t.bind(n,5333,19))],a=[],s=0,i=t.length;for(;s<i;s++)e=await t[s](),a.push(e);return self.fc||(self.fc={},a.forEach((e=>{Object.keys(e).length>0&&Object.assign(self.fc,e)}))),Promise.resolve()}render(){let e=this,t=5*(.51+.49*Math.sin(Date.now()/1e3));e.stopAnimation||(e.xScale.domain([-t,t]),e.yScale.domain([-t,t]),e.series(e.data),requestAnimationFrame(e.render.bind(e)))}renderSeries(e,t=!1){let n,a=this;a.canvasId=e,a.series&&(n=Neo.currentWorker.map[e].getContext("webgl"),a.series.context(n),!t&&a.render())}updateSize(e){let t=this;if(t.canvasSize=e,t.series){let n=t.series.context();Object.assign(n.canvas,{height:e.height,width:e.width}),n.viewport(0,0,n.canvas.width,n.canvas.height)}}}const i=Neo.setupClass(s),r=()=>{console.log(i)}}}]);
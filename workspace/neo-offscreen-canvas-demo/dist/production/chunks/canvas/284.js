"use strict";(self.webpackChunkneo_offscreen_canvas_demo=self.webpackChunkneo_offscreen_canvas_demo||[]).push([[284],{1284:(e,t,n)=>{n.r(t),n.d(t,{onStart:()=>o});var a=n(5074);class s extends a.Z{canvasId=null;canvasSize=null;data=null;series=null;xScale=null;yScale=null;static getConfig(){return{className:"MyApp.canvas.Helper",singleton:!0,itemsAmount_:1e4,remote:{app:["changeItemsAmount","enableAnimation","renderSeries","updateSize"]},stopAnimation_:!1}}constructor(e){super(e);let t=this;t.promiseImportD3().then((()=>{t.xScale=d3.scaleLinear().domain([-5,5]),t.yScale=d3.scaleLinear().domain([-5,5]),t.generateData(),t.generateSeries(),t.canvasId&&(t.renderSeries(t.canvasId),t.updateSize(t.canvasSize))}))}afterSetItemsAmount(e,t){if(e&&Neo.isNumber(t)){let e=this;e.stopAnimation=!0,e.generateData(),e.generateSeries(),e.renderSeries(e.canvasId,!0),e.stopAnimation=!1}}afterSetStopAnimation(e,t){!e&&Neo.isBoolean(t)&&this.render()}changeItemsAmount(e){this.itemsAmount=e}enableAnimation(e){this.stopAnimation=!e}generateData(){let e=d3.randomNormal(0,1),t=d3.randomLogNormal();this.data=Array.from({length:this.itemsAmount},(()=>({x:e(),y:e(),size:10*t()})))}generateSeries(){let e=this,t=d3.scaleOrdinal(d3.schemeAccent),n=fc.seriesWebglPoint().xScale(e.xScale).yScale(e.yScale).crossValue((e=>e.x)).mainValue((e=>e.y)).size((e=>e.size)).equals((e=>e.length>0)),a=fc.webglFillColor().value(((e,n)=>(e=>{let{r:t,g:n,b:a,opacity:s}=d3.color(e).rgb();return[t/255,n/255,a/255,s]})(t(n)))).data(e.data);n.decorate((e=>a(e))),e.series=n}async promiseImportD3(){let e,t=[()=>n.e(250).then(n.bind(n,4250)),()=>n.e(465).then(n.bind(n,3465)),()=>n.e(79).then(n.bind(n,3079)),()=>n.e(498).then(n.bind(n,6498)),()=>n.e(172).then(n.bind(n,2172)),()=>n.e(986).then(n.bind(n,7986)),()=>n.e(297).then(n.bind(n,3297)),()=>n.e(850).then(n.bind(n,850)),()=>n.e(598).then(n.bind(n,1598)),()=>Promise.all([n.e(951),n.e(550)]).then(n.t.bind(n,3288,19)),()=>n.e(135).then(n.t.bind(n,4135,19)),()=>n.e(318).then(n.t.bind(n,3318,19)),()=>Promise.all([n.e(683),n.e(951),n.e(165)]).then(n.t.bind(n,8165,19)),()=>Promise.all([n.e(683),n.e(537)]).then(n.t.bind(n,537,19))],a=[],s=0,i=t.length;for(;s<i;s++)e=await t[s](),a.push(e);return self.fc||(self.fc={},a.forEach((e=>{Object.keys(e).length>0&&Object.assign(self.fc,e)}))),Promise.resolve()}render(){let e=this,t=5*(.51+.49*Math.sin(Date.now()/1e3));e.stopAnimation||(e.xScale.domain([-t,t]),e.yScale.domain([-t,t]),e.series(e.data),requestAnimationFrame(e.render.bind(e)))}renderSeries(e,t=!1){let n,a=this;a.canvasId=e,a.series&&(n=Neo.currentWorker.map[e].getContext("webgl"),a.series.context(n),!t&&a.render())}updateSize(e){let t=this;if(t.canvasSize=e,t.series){let n=t.series.context();Object.assign(n.canvas,{height:e.height,width:e.width}),n.viewport(0,0,n.canvas.width,n.canvas.height)}}}Neo.applyClassConfig(s);let i=Neo.create(s);Neo.applyToGlobalNs(i);const r=i,o=()=>{console.log(r)}}}]);